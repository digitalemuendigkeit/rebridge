---
title: "Code-Archiv"
author: "Stefan"
date: "8 11 2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(haven)
library(sjPlot)
library(sjlabelled)
library(kableExtra)
library(knitr)
library(apastats)
```

# Bildungs Labor
```{r}
data_demograph  %>% ggplot() + 
                    aes(x = factor(school), fill = factor(gender)) + 
                    geom_bar(position = "dodge",) + 
                    scale_x_discrete(labels=c(`1` = "keine Schulausbildung", `2` = "Volks-/Hauptschulabschluss", `3` = "Realschulabschluss", `4` = "(Fach-)Abitur", `5` = "Sonstiges")) +
                    ylab("Anzahl") + 
                    scale_fill_discrete(name="Geschlecht",labels=c("männlich", "weiblich")) +
                    coord_flip() 
```

```{r}
# x- Achse: school
# y- Achse: ..prop.. → Wahrscheinlichkeiten
# facet_grid → teilt den Graph in mehrere Teile
# fill: färbt die Skalen ein, fügt Farb-Legende hinzu.
# geom_text: fügt Beschriftungen an einzelnen Balken hinzu.

ggplot(data=data_demograph, aes(x=school)) + 
    geom_bar(aes(y = ..prop.., fill = factor(..x..))) +
    geom_text(aes( label = scales::percent(..prop..), y= ..prop.. ), stat= "count", vjust = -0.1) +
    labs(y = "Prozent", x="") +
    coord_cartesian(ylim=c(0,0.8))+
    scale_fill_discrete(name= "Abschluss", guide = guide_legend(reverse = TRUE), labels = c("keine Schulausbildung",
                                                            "Volks-/Hauptschulabschluss",
                                                            "Realschulabschluss",
                                                            "(Fach-)Abitur",
                                                            "Sonstiges")) +
    facet_grid(data_demograph$gender, labeller = as_labeller(c(`1` = "männlich", `2` = "weiblich"))) +
    scale_y_continuous(labels = scales::percent) +
    scale_x_discrete()
```

```{r}
data_demograph  %>% ggplot(aes(x = school,
                               y = ..prop..,
                               fill = factor(gender))) + 
                    geom_bar(position = "dodge") + 
                    geom_text(aes(label = scales::percent(..prop..),      y= ..prop.. ),
                              stat= "count", position = position_dodge(width = 1), hjust = -0.1) +
                    labs(y = "Anteil in %", x="Abschluss") +
                    scale_fill_manual(values = c("skyblue","royalblue"),
                                      name="Geschlecht",
                                      labels=c("männlich", "weiblich")) +
                    guides(fill = guide_legend(reverse = TRUE)) +
                    coord_flip(ylim=c(0,0.8))+
                    scale_x_reverse(breaks = 1:5,labels = c("keine Schulausbildung",
                                                            "Volks-/Hauptschulabschluss",
                                                            "Realschulabschluss",
                                                            "(Fach-)Abitur",
                                                            "Sonstiges")) +
                    scale_y_continuous(labels = scales::percent)


```

# Topic Labor

```{r}
# Finde alle NA und ersetzte NA durch 9 
data_topicSelect$interestingTopic[is.na(data_topicSelect$interestingTopic)] <-9
data_topicSelect  %>% ggplot(aes(x = interestingTopic,
                               y = ..prop..,
                               fill = factor(data_demograph$gender))) + 
                    geom_bar(position = "dodge") + 
                    geom_text(aes(label = scales::percent(..prop..),      y= ..prop.. ),
                    stat= "count", position = position_dodge(width = 1), hjust = -0.1) +
                    labs(y = "Anteil in %", x="Thema") +
                    scale_fill_manual(values = c("skyblue","royalblue"),
                                      name="Geschlecht",
                                      labels=c("männlich", "weiblich")) +
                    guides(fill = guide_legend(reverse = TRUE)) +
                    coord_flip(ylim=c(0,0.33))+
                    scale_x_reverse(breaks = 1:9,labels = c("Politik","Games","Wirtschaft","Kultur","Lifestyle","Computer & Technik","Netzpolitik","Wissenschaft","keine Angabe")) +
                    scale_y_continuous(labels = scales::percent)

```


# Boxplot Labor

```{r}
ggplot(data_kut,aes(x=data_cleaned$gender, y=KUT, group=as.numeric(data_cleaned$gender)))+
      geom_boxplot()+
      labs(x ="Geschlecht", y = "") +
      scale_x_continuous(breaks = 1:2, labels = c("männlich","weiblich")) +
      coord_cartesian(ylim = c(1,6)) +
      geom_jitter(shape=16, position=position_jitter(0.05))

# Mehrere Spalten in zwei Spalten (Bezeichnung, Wert) zusammenfassen:
# pivot_longer(cols = NAME_ALLER_SPALTEN,names_to = "BEZEICHNUNG", values_to = "WERT")
data_empf_gen <- data_RS_einschaetzung %>% select(-ResponseId) %>% pivot_longer(cols= starts_with("einsch"), names_to = "Empfehlungssystem", values_to = "Genauigkeit")

# Boxplot mit Punktgraph
ggplot(data_empf_gen, aes(x=Empfehlungssystem, y=Genauigkeit))+
      geom_boxplot() +
      #scale_x_discrete(labels = c("A","B","C","D","E","F")) +
      geom_dotplot(binaxis='y', method= "histodot", stackdir='centerwhole', binwidth=1.2, stackratio = 1.4, fill = "royalblue", color = "darkblue") +
      scale_y_continuous(labels = scales::unit_format(suffix =" %"))

# Boxplot mit Violingraph
ggplot(data_empf_gen, 
       aes(x=reorder(Empfehlungssystem, Genauigkeit, FUN = mean), 
           y=Genauigkeit))+
      geom_violin(alpha = 0.6, 
                  fill = "lightblue") +
      geom_boxplot(alpha = 0.8) +
      labs(x = "Empfehlungssystem") +
      scale_x_discrete(labels = c("Random","Popular","IBCF","UBCF","Content","Hybrid")) +
      scale_y_continuous(labels = scales::unit_format(suffix =" %"))
```


```{r}
data_pub_gen <- data_publishing %>% select(-ResponseId)
data_pub_gen$RS_dataPublishing_1 <- as.numeric(data_pub_gen$RS_dataPublishing_1)
data_pub_gen$RS_dataPublishing_2 <- as.numeric(data_pub_gen$RS_dataPublishing_2)
data_pub_gen$RS_dataPublishing_3 <- as.numeric(data_pub_gen$RS_dataPublishing_3)
data_pub_gen$RS_dataPublishing_4 <- as.numeric(data_pub_gen$RS_dataPublishing_4)
data_pub_gen$RS_dataPublishing_5 <- as.numeric(data_pub_gen$RS_dataPublishing_5)
data_pub_gen$RS_dataPublishing_6 <- as.numeric(data_pub_gen$RS_dataPublishing_6)
data_pub_gen$RS_dataPublishing_7 <- as.numeric(data_pub_gen$RS_dataPublishing_7)

data_pub_gen <- data_pub_gen %>% pivot_longer(cols= c(starts_with("RS")), names_to = "Datentyp", values_to = "Bereitschaft")

ggplot(data_pub_gen, 
       aes(x=reorder(Datentyp, Bereitschaft, FUN = mean), 
           y=Bereitschaft))+
      geom_violin(alpha = 0.6, 
                  fill = "lightblue") +
      geom_boxplot(alpha = 0.7) +
      labs(x = "Datentyp") +
      scale_x_discrete(labels = c("Standort","Politische Einstellung","Religion","Geschlecht/Alter","Bewertung","Hobby","Themengebiete")) +
      scale_y_continuous(breaks = seq(1, 6, by = 1)) +
      coord_cartesian(ylim = c(1,6)) 
```

```{r}
ggplot(data_priv,aes(x=data_cleaned$gender, y=RS_Privacy_Consern, group=as.numeric(data_cleaned$gender)))+
      geom_violin(alpha = 0.6, fill = "lightblue") +
      geom_boxplot(alpha = 0.7)+
      labs(x ="Geschlecht", y = "Einstellung zur Privatsphäre eines Empfehlungssystems") +
      scale_x_continuous(breaks = 1:2, labels = c("männlich","weiblich")) +
      scale_y_continuous(breaks = seq(1, 6, by = 0.5)) +
      coord_cartesian(ylim = c(1,6)) 
```

